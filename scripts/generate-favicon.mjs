import sharp from 'sharp';
import { writeFileSync } from 'fs';
import { join, dirname } from 'path';
import { fileURLToPath } from 'url';

const __dirname = dirname(fileURLToPath(import.meta.url));
const publicDir = join(__dirname, '..', 'public');
const appDir = join(__dirname, '..', 'src', 'app');

// Create a simple favicon with the MP logo on black background
const svgContent = `
<svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
  <rect width="32" height="32" fill="#000000"/>
  <g transform="translate(2, 4) scale(0.145)">
    <path fill="#bcbcbc" d="m155.518,87.759c-4.662-1.852-9.492-1.005-14.423-1.287v36.628c2.867,0,5.65.076,8.428-.014,8.556-.276,15.963-6.722,17.312-14.991,1.442-8.838-3.199-17.112-11.317-20.337Z"/>
    <path fill="#bcbcbc" d="m138.138,86.564c-1.863,0-3.541,0-5.22,0-11.414.006-19.787,8.362-19.793,19.769-.007,12.186-.004,26.151-.004,38.337h5.223c11.437-.034,19.779-8.364,19.791-19.79.013-12.186.003-24.372.003-36.557v-1.758Zm-4.659,39.203c-.054,8.295-7.483,15.032-15.677,14.183l-.073-1.386.007-32.371c.037-8.569,6.535-15.136,14.805-15.074.241.002.483.034.818.059.049.418.133.796.133,1.174.007,11.138.061,22.277-.012,33.415Z"/>
    <path fill="#ffffff" d="m107.635,144.553c-.531.03-.913.068-1.296.07-13.105.074-23.402-7.729-23.46-17.91l-.011-38.462.116-1.647c12.984-1.009,24.756,6.996,24.842,16.851.115,13.234.03,26.468.019,39.703,0,.449-.132.898-.21,1.395Z"/>
    <path fill="#ffffff" d="m80.301,144.553c-.531.03-.913.068-1.296.07-13.105.074-23.402-7.729-23.46-17.91l-.011-38.462.116-1.647c12.984-1.009,24.756,6.996,24.842,16.851.115,13.234.03,26.468.019,39.703,0,.449-.132.898-.21,1.395Z"/>
    <path fill="#ffffff" d="m52.966,144.553c-.531.03-.913.068-1.296.07-13.105.074-23.402-7.729-23.46-17.91l-.011-38.462.116-1.647c12.984-1.009,24.756,6.996,24.842,16.851.115,13.234.03,26.468.019,39.703,0,.449-.132.898-.21,1.395Z"/>
  </g>
</svg>`;

async function generateFavicons() {
  const svgBuffer = Buffer.from(svgContent);

  // Generate favicon-16x16.png
  await sharp(svgBuffer)
    .resize(16, 16)
    .png()
    .toFile(join(publicDir, 'favicon-16x16.png'));
  console.log('Generated favicon-16x16.png');

  // Generate favicon-32x32.png
  await sharp(svgBuffer)
    .resize(32, 32)
    .png()
    .toFile(join(publicDir, 'favicon-32x32.png'));
  console.log('Generated favicon-32x32.png');

  // Generate icon.png (192x192)
  const svg192 = `
<svg width="192" height="192" viewBox="0 0 192 192" xmlns="http://www.w3.org/2000/svg">
  <rect width="192" height="192" fill="#000000"/>
  <g transform="translate(12, 24) scale(0.87)">
    <path fill="#bcbcbc" d="m155.518,87.759c-4.662-1.852-9.492-1.005-14.423-1.287v36.628c2.867,0,5.65.076,8.428-.014,8.556-.276,15.963-6.722,17.312-14.991,1.442-8.838-3.199-17.112-11.317-20.337Z"/>
    <path fill="#bcbcbc" d="m138.138,86.564c-1.863,0-3.541,0-5.22,0-11.414.006-19.787,8.362-19.793,19.769-.007,12.186-.004,26.151-.004,38.337h5.223c11.437-.034,19.779-8.364,19.791-19.79.013-12.186.003-24.372.003-36.557v-1.758Zm-4.659,39.203c-.054,8.295-7.483,15.032-15.677,14.183l-.073-1.386.007-32.371c.037-8.569,6.535-15.136,14.805-15.074.241.002.483.034.818.059.049.418.133.796.133,1.174.007,11.138.061,22.277-.012,33.415Z"/>
    <path fill="#ffffff" d="m107.635,144.553c-.531.03-.913.068-1.296.07-13.105.074-23.402-7.729-23.46-17.91l-.011-38.462.116-1.647c12.984-1.009,24.756,6.996,24.842,16.851.115,13.234.03,26.468.019,39.703,0,.449-.132.898-.21,1.395Z"/>
    <path fill="#ffffff" d="m80.301,144.553c-.531.03-.913.068-1.296.07-13.105.074-23.402-7.729-23.46-17.91l-.011-38.462.116-1.647c12.984-1.009,24.756,6.996,24.842,16.851.115,13.234.03,26.468.019,39.703,0,.449-.132.898-.21,1.395Z"/>
    <path fill="#ffffff" d="m52.966,144.553c-.531.03-.913.068-1.296.07-13.105.074-23.402-7.729-23.46-17.91l-.011-38.462.116-1.647c12.984-1.009,24.756,6.996,24.842,16.851.115,13.234.03,26.468.019,39.703,0,.449-.132.898-.21,1.395Z"/>
  </g>
</svg>`;
  await sharp(Buffer.from(svg192))
    .resize(192, 192)
    .png()
    .toFile(join(publicDir, 'icon.png'));
  console.log('Generated icon.png');

  // Generate apple-touch-icon.png (180x180)
  const svg180 = `
<svg width="180" height="180" viewBox="0 0 180 180" xmlns="http://www.w3.org/2000/svg">
  <rect width="180" height="180" fill="#000000"/>
  <g transform="translate(10, 22) scale(0.82)">
    <path fill="#bcbcbc" d="m155.518,87.759c-4.662-1.852-9.492-1.005-14.423-1.287v36.628c2.867,0,5.65.076,8.428-.014,8.556-.276,15.963-6.722,17.312-14.991,1.442-8.838-3.199-17.112-11.317-20.337Z"/>
    <path fill="#bcbcbc" d="m138.138,86.564c-1.863,0-3.541,0-5.22,0-11.414.006-19.787,8.362-19.793,19.769-.007,12.186-.004,26.151-.004,38.337h5.223c11.437-.034,19.779-8.364,19.791-19.79.013-12.186.003-24.372.003-36.557v-1.758Zm-4.659,39.203c-.054,8.295-7.483,15.032-15.677,14.183l-.073-1.386.007-32.371c.037-8.569,6.535-15.136,14.805-15.074.241.002.483.034.818.059.049.418.133.796.133,1.174.007,11.138.061,22.277-.012,33.415Z"/>
    <path fill="#ffffff" d="m107.635,144.553c-.531.03-.913.068-1.296.07-13.105.074-23.402-7.729-23.46-17.91l-.011-38.462.116-1.647c12.984-1.009,24.756,6.996,24.842,16.851.115,13.234.03,26.468.019,39.703,0,.449-.132.898-.21,1.395Z"/>
    <path fill="#ffffff" d="m80.301,144.553c-.531.03-.913.068-1.296.07-13.105.074-23.402-7.729-23.46-17.91l-.011-38.462.116-1.647c12.984-1.009,24.756,6.996,24.842,16.851.115,13.234.03,26.468.019,39.703,0,.449-.132.898-.21,1.395Z"/>
    <path fill="#ffffff" d="m52.966,144.553c-.531.03-.913.068-1.296.07-13.105.074-23.402-7.729-23.46-17.91l-.011-38.462.116-1.647c12.984-1.009,24.756,6.996,24.842,16.851.115,13.234.03,26.468.019,39.703,0,.449-.132.898-.21,1.395Z"/>
  </g>
</svg>`;
  await sharp(Buffer.from(svg180))
    .resize(180, 180)
    .png()
    .toFile(join(publicDir, 'apple-touch-icon.png'));
  console.log('Generated apple-touch-icon.png');

  console.log('\nAll favicons generated successfully!');
  console.log('Note: For favicon.ico, Next.js will use the dynamic icon.tsx in src/app/');
}

generateFavicons().catch(console.error);
